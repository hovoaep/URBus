<!doctype html>

<html lang="en">
<head>

  <meta charset="utf-8">
  <title>Bus App</title>
    <link rel="stylesheet" type="text/css" href="styles/font-awesome.css">
  <link rel="stylesheet" type="text/css" href="styles/styles.css">


</head>

<body>
<script
  src="https://code.jquery.com/jquery-3.2.1.min.js"
  integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4="
  crossorigin="anonymous"></script>
	
	<div class="topBar">
		<div class="inputFields">
			<form onSubmit="submitHanlder(event);">
				<input type='text' id="start" placeholder="Start">
				<input type='text' id="end" placeholder="End">
				<input type='submit' id="submitButton">
			</form>
		</div>
		<div class="weather">
			<div class="sunIcon">
				<i class="fa fa-sun-o" aria-hidden="true"></i>
				<div id='sunNumber'></div>
				
			</div>
			<div class="rainIcon">
				<i class="fa fa-tint" aria-hidden="true"></i>
				<div id='rainNumber'></div>
			</div>
			
			
		</div>
		<div class="clear">
		</div>
	</div>
	<div id="expandSection">

	</div>
	<script type="text/javascript">
	//checking if one is even set
	//document.cookie === undefined

	if(document.cookie.indexOf('|')){
		//break apart cookie
		var startDown = true;
		var endDown = true;
		var cookie = document.cookie;
		console.log(document.cookie.indexOf('|'));
		cookieSplit = cookie.split("|");

		var startPostions = cookieSplit[0];
		var endPostions = cookieSplit[1];

		if( startPostions.indexOf(',') && endPostions.indexOf(',') ){

			startPostions = startPostions.split(',');
			endPostions = endPostions.split(',');

			var startLength = startPostions.length;
			var endLength = endPostions.length;

			var expandSection = document.getElementById('expandSection');

			
			for (var i = 0; i < startLength; i++) {
				var pTag = document.createElement('p');
			    pTag.appendChild(function(){
			    	return document.createTextNode(startPostions[i])});
			    console.log(startPostions);
			    pTag.className = 'startShow';
			    expandSection.appendChild(pTag);
			}

			for (var i = 0; i < endLength; i++) {
				var pTag = document.createElement('p');
			    pTag.appendChild(document.createTextNode(endPostions[i]));
			    pTag.className = 'endShow';
			    expandSection.appendChild(pTag);
			}

			$( "#start" ).focus(function() {
	  			if(startDown){
	  				$('.startShow').css('display','block');
	  				$('.endShow').css('display','none');
	  				startDown = false;
	  				endDown = true;
	  			}
		 	});
			$( "#end" ).focus(function() {
				if(endDown){
					$('.endShow').css('display','block');
					$('.startShow').css('display','none');
					endDown = false;
					startDown = true;
				}
		 	});
	}
	}
	//when inputs are focus show div
	
	 
	// function for handling on submit
		function submitHanlder(e) {
			e.preventDefault();
			var start = document.getElementById('start').value;
			var end = document.getElementById('end').value;

			if(start === undefined || end === undefined){
				console.log("d-d")
				return false;
			}

			//setting cookie for previous searches
			var previousCookie = "";
			previousCookie = document.cookie;
			console.log(previousCookie);
			//getting start and end
			startEndCookie = previousCookie.split('|');

			if(startEndCookie[1] === undefined){
				//user's first time here
				console.log("users first time");
				var string = start + "|"+ end;
				console.log(string);
				document.cookie = string.toString();
				console.log(document.cookie);
				return false;
			}

			//checking if already stored for start
			if(!(startEndCookie[0].indexOf(start))){
				startEndCookie[0] = startEndCookie[0] + "," + start;
			}

			//checking if already stored for end
			if(!(startEndCookie[1].indexOf(end))){
				startEndCookie[1] = startEndCookie[1] + "," + end;
			}
		
			document.cookie = startEndCookie[0] + "|" + startEndCookie[1];
			//cookies have been set...
			return false;
		}
	</script>
	
	<div id='map'>

	</div>
	
 	<script src="js/home.js"></script>
	    <script>
	    	var map = "";
	      function initMap() {
	        var uluru = {lat: 43.128397, lng: -77.628681};
	        map = new google.maps.Map(document.getElementById('map'), {
	          zoom: 15,
	          center: uluru,
	          disableDefaultUI: true,
	          clickableIcons: true
	        });

	      }
	    </script>
	    <script async defer src="https://maps.googleapis.com/maps/api/js?key=AIzaSyDfWoPWJw8uWXprI_uL3D1TQ10Df-atWkY&callback=initMap"></script>
 
</body>
</html>